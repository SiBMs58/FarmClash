<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="../../static/css/UI.css">
    <title>game UI</title>
</head>
<body>
    <header>
        <button id="home-btn" class="home-btn">
            <a href="{{ url_for('main') }}">
                <img src="../../static/img/UI/home_btn.png" alt="🏡">
            </a>
        </button>

        <button id="resource-btn" class="resource-btn" onclick="clickResources()">
            <img src="../../static/img/UI/resource_btn.png" alt="🌱">
        </button>
        <div class="overlay" id="resource-overlay">
            <div class="popup">
                <!-- The resource amounts of the user will be inserted here dynamically -->
            </div>
        </div>

        <div class="money-display">
            <p>0</p> <!-- This will be updated dynamically -->
            <img src="../../static/img/resources/Coin.png" alt="🪙">
        </div>

        <button id="setting-btn" class="setting-btn">
            <a href="{{ url_for('settings') }}">
                <img src="../../static/img/UI/setting_btn.png" alt="⚙️">
            </a>
        </button>
        <button id="chat-btn" class="chat-btn">
            <a href="{{ url_for('friends.dashboard') }}">
                <img src="../../static/img/UI/chat_btn.png" alt="💬">
            </a>
        </button>
    </header>
    <script>
        let clickedResourceButton = false;

        function clickResources() {
            const resourceButton = document.getElementById('resource-btn');
            const overlay = document.getElementById('resource-overlay');

            overlay.style.display = clickedResourceButton ? 'none' : 'flex';
           resourceButton.querySelector('img').src = clickedResourceButton ? "../static/img/UI/resource_btn.png" : "../static/img/UI/resource_pbtn.png";
            clickedResourceButton = !clickedResourceButton;

            fetch('/api/resources')
            .then(response => response.json())
            .then(data => {
                updateResources(data);
                updateMoney(data); // Call a separate function to update money
            })
            .catch(error => {
                console.error('Error fetching resources:', error);
                document.querySelector('.popup').innerHTML = `<p>Error fetching resources. Please try again later.</p>`;
            });
        }

        function updateResources(resources) {
            const popupDiv = document.querySelector('.popup');
            let resourceHTML = '';

            resources.forEach(resource => {
                if(resource.resource_type === 'Money') return; // Skip money

                const symbol = getImage(resource.resource_type);
                resourceHTML += `<p>${resource.amount}${symbol}</p>`;
            });

            popupDiv.innerHTML = resourceHTML;
        }

        function updateMoney(resources) {
            const moneyDisplay = document.querySelector('.money-display p');
            const moneyResource = resources.find(resource => resource.resource_type === 'Money');

            if(moneyResource) {
                moneyDisplay.textContent = `${moneyResource.amount}`;
            }
        }

        function getImage(resourceType) {
            switch(resourceType) {
                case 'Corn': return '<img src="../../static/img/resources/Corn.png" alt="🌽">';
                case 'Carrot': return '<img src="../../static/img/resources/Carrot.png" alt="🥕">';
                case 'Cauliflower': return '<img src="../../static/img/resources/Cauliflower.png" alt="⚪🥦">';
                case 'Tomato': return '<img src="../../static/img/resources/Tomato.png" alt="🍅">';
                case 'Eggplant': return '<img src="../../static/img/resources/Eggplant.png" alt="🍆">';
                case 'Lettuce': return '<img src="../../static/img/resources/Lettuce.png" alt="🥬">';
                case 'Wheat': return '<img src="../../static/img/resources/Wheat.png" alt="🌾">';
                case 'Turnip': return '<img src="../../static/img/resources/Turnip.png" alt="🟣🌱">';
                case 'Parsnip': return '<img src="../../static/img/resources/Parsnip.png" alt="⚪🌱">';
                case 'Zucchini': return '<img src="../../static/img/resources/Zucchini.png" alt="🥒">';
                // Add more as needed
                default: return ''; // Default case if no symbol is matched
            }
        }
    </script>






    <footer>
        <button id="market-btn" class="market-btn">
            <a href="{{ url_for('market.market') }}">
                <img src="../../static/img/UI/market_btn.png" alt="🛒">
            </a>
        </button>
        <div class="copyright">
            &copy; Team3 – Universiteit Antwerpen - PPDB
        </div>
        <button id="attack-btn" class="attack-btn">
            <a href="{{ url_for('attack') }}">
                <img src="../../static/img/UI/attack_btn.png" alt="⚔️">
            </a>
        </button>
    </footer>
</body>
</html>
