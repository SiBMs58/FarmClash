<html>
<head>
    <title>{{ app_data['app_name'] }} - Admin Dashboard</title>
    {% include 'head.html' %}

</head>
<body>
    {% include 'header.html' %}

    <div class="container-fluid mt-5">
        <div class="row justify-content-center">
            <div class="col-md-10 text-center">
                <h1>Admin Dashboard</h1>

                <!-- User State Section -->
                <div class="user-state-section my-4">
                    <h2>Users</h2>
                    <!-- Example: List of Users -->
                    <div>
                        <ul class="user-list">
                            <!-- User items will be populated here -->
                        </ul>
                    </div>
                </div>

                <!-- Map State Section -->
                <div class="map-state-section my-4">
                    <h2>Maps</h2>
                    <!-- Example: List of Maps -->
                    <div>
                        <ul class="map-list">
                            <!-- Map items will be populated here -->
                        </ul>
                    </div>
                </div>

                <!-- API Test Section
                <div class="api-test-section my-4">
                    <h2>Test API Requests</h2>
                    <p>Use the form below to test API requests.</p>
                    <form id="api-test-form">
                        <div class="mb-3">
                            <label for="api-endpoint" class="form-label">API Endpoint</label>
                            <input type="text" class="form-control" id="api-endpoint" placeholder="/api/users">
                        </div>
                        <div class="mb-3">
                            <label for="api-method" class="form-label">Method</label>
                            <select class="form-select" id="api-method">
                                <option>GET</option>
                                <option>POST</option>
                                <option>PUT</option>
                                <option>DELETE</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="api-body" class="form-label">Request Body (JSON)</label>
                            <textarea class="form-control" id="api-body" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Send Request</button>
                    </form>
                </div> -->

                <div class="my-3">
                    <a href="{{ url_for('auth.logout') }}">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Fetch and display user states
        fetch('/api/users')
            .then(response => response.json())
            .then(users => {
                const userList = document.querySelector('.user-list');
                users.forEach(user => {
                    const listItem = document.createElement('li');
                    listItem.textContent = `User: ${user.username}, Email: ${user.email}, Created At: ${user.created_at}`;
                    userList.appendChild(listItem);
                });
            });

        // Add fetching and displaying maps
        // Fetch and display map states
        fetch('/api/maps')
            .then(response => response.json())
            .then(maps => {
                const mapList = document.querySelector('.map-list');
                maps.forEach(map => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `Map ID: ${map.map_id}, User: ${map.username}, Width: ${map.map_width}, Height: ${map.map_height}, Created At: ${map.created_at}`;

                    // Create a button for showing terrain data
                    const showTerrainButton = document.createElement('button');
                    showTerrainButton.innerText = 'Show Terrain';
                    showTerrainButton.addEventListener('click', () => {
                        // Display the terrain data, consider using a modal for a better UX
                        alert(JSON.stringify(map.terrain_tiles, null, 2));
                    });

                    // Append the button to the listItem
                    listItem.appendChild(showTerrainButton);

                    // Append the listItem to the mapList
                    mapList.appendChild(listItem);
                });
            });

        /*// Handle form submission for API testing
        document.getElementById('api-test-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const data = {
                endpoint: document.getElementById('api-endpoint').value,
                method: document.getElementById('api-method').value,
                // Include other fields as necessary
            };

            fetch('/api/test', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                console.log('API Test Success:', data);
                // Optionally display the test result on the page
            })
            .catch((error) => {
                console.error('API Test Error:', error);
            });
        });*/
    });
    </script>


    {% include 'footer.html' %}
</body>
</html>
